(function(f){var A={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:false,autoCheckTrigger:false,chkStyle:A.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:A.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},w=function(B){var C=z.getRoot(B);C.radioCheckedList=[]},d=function(B){},o=function(B){var C=B.treeObj,D=r.event;C.bind(D.CHECK,function(G,F,H,E){G.srcEvent=F;u.apply(B.callback.onCheck,[G,H,E])})},y=function(B){var C=B.treeObj,D=r.event;C.unbind(D.CHECK)},p=function(H){var I=H.target,K=z.getSetting(H.data.treeId),F="",C=null,D="",G="",B=null,E=null;if(u.eqs(H.type,"mouseover")){if(K.check.enable&&u.eqs(I.tagName,"span")&&I.getAttribute("treeNode"+r.id.CHECK)!==null){F=u.getNodeMainDom(I).id;D="mouseoverCheck"}}else{if(u.eqs(H.type,"mouseout")){if(K.check.enable&&u.eqs(I.tagName,"span")&&I.getAttribute("treeNode"+r.id.CHECK)!==null){F=u.getNodeMainDom(I).id;D="mouseoutCheck"}}else{if(u.eqs(H.type,"click")){if(K.check.enable&&u.eqs(I.tagName,"span")&&I.getAttribute("treeNode"+r.id.CHECK)!==null){F=u.getNodeMainDom(I).id;D="checkNode"}}}}if(F.length>0){C=z.getNodeCache(K,F);switch(D){case"checkNode":B=m.onCheckNode;break;case"mouseoverCheck":B=m.onMouseoverCheck;break;case"mouseoutCheck":B=m.onMouseoutCheck;break}}var J={stop:D==="checkNode",node:C,nodeEventType:D,nodeEventCallback:B,treeEventType:G,treeEventCallback:E};return J},v=function(J,D,F,G,I,H,E){if(!F){return}var C=J.data.key.checked;if(typeof F[C]=="string"){F[C]=u.eqs(F[C],"true")}F[C]=!!F[C];F.checkedOld=F[C];if(typeof F.nocheck=="string"){F.nocheck=u.eqs(F.nocheck,"true")}F.nocheck=!!F.nocheck||(J.check.nocheckInherit&&G&&!!G.nocheck);if(typeof F.chkDisabled=="string"){F.chkDisabled=u.eqs(F.chkDisabled,"true")}F.chkDisabled=!!F.chkDisabled||(J.check.chkDisabledInherit&&G&&!!G.chkDisabled);if(typeof F.halfCheck=="string"){F.halfCheck=u.eqs(F.halfCheck,"true")}F.halfCheck=!!F.halfCheck;F.check_Child_State=-1;F.check_Focus=false;F.getCheckStatus=function(){return z.getCheckStatus(J,F)};if(J.check.chkStyle==r.radio.STYLE&&J.check.radioType==r.radio.TYPE_ALL&&F[C]){var B=z.getRoot(J);B.radioCheckedList.push(F)}},a=function(D,E,C){var B=D.data.key.checked;if(D.check.enable){z.makeChkFlag(D,E);C.push("<span ID='",E.tId,r.id.CHECK,"' class='",k.makeChkClass(D,E),"' treeNode",r.id.CHECK,(E.nocheck===true?" style='display:none;'":""),"></span>")}},l=function(D,C){C.checkNode=function(I,H,J,G){var E=this.setting.data.key.checked;if(I.chkDisabled===true){return}if(H!==true&&H!==false){H=!I[E]}G=!!G;if(I[E]===H&&!J){return}else{if(G&&u.apply(this.setting.callback.beforeCheck,[this.setting.treeId,I],true)==false){return}}if(u.uCanDo(this.setting)&&this.setting.check.enable&&I.nocheck!==true){I[E]=H;var F=j(I,r.id.CHECK,this.setting);if(J||this.setting.check.chkStyle===r.radio.STYLE){k.checkNodeRelation(this.setting,I)}k.setChkClass(this.setting,F,I);k.repairParentChkClassWithSelf(this.setting,I);if(G){this.setting.treeObj.trigger(r.event.CHECK,[null,this.setting.treeId,I])}}};C.checkAllNodes=function(E){k.repairAllChk(this.setting,!!E)};C.getCheckedNodes=function(F){var E=this.setting.data.key.children;F=(F!==false);return z.getTreeCheckedNodes(this.setting,z.getRoot(this.setting)[E],F)};C.getChangeCheckedNodes=function(){var E=this.setting.data.key.children;return z.getTreeChangeCheckedNodes(this.setting,z.getRoot(this.setting)[E])};C.setChkDisabled=function(F,E,G,H){E=!!E;G=!!G;H=!!H;k.repairSonChkDisabled(this.setting,F,E,H);k.repairParentChkDisabled(this.setting,F.getParentNode(),E,G)};var B=C.updateNode;C.updateNode=function(G,H){if(B){B.apply(C,arguments)}if(!G||!this.setting.check.enable){return}var E=j(G,this.setting);if(E.get(0)&&u.uCanDo(this.setting)){var F=j(G,r.id.CHECK,this.setting);if(H==true||this.setting.check.chkStyle===r.radio.STYLE){k.checkNodeRelation(this.setting,G)}k.setChkClass(this.setting,F,G);k.repairParentChkClassWithSelf(this.setting,G)}}},q={getRadioCheckedList:function(E){var D=z.getRoot(E).radioCheckedList;for(var C=0,B=D.length;C<B;C++){if(!z.getNodeCache(E,D[C].tId)){D.splice(C,1);C--;B--}}return D},getCheckStatus:function(C,E){if(!C.check.enable||E.nocheck||E.chkDisabled){return null}var B=C.data.key.checked,D={checked:E[B],half:E.halfCheck?E.halfCheck:(C.check.chkStyle==r.radio.STYLE?(E.check_Child_State===2):(E[B]?(E.check_Child_State>-1&&E.check_Child_State<2):(E.check_Child_State>0)))};return D},getTreeCheckedNodes:function(J,C,I,F){if(!C){return[]}var D=J.data.key.children,B=J.data.key.checked,H=(I&&J.check.chkStyle==r.radio.STYLE&&J.check.radioType==r.radio.TYPE_ALL);F=!F?[]:F;for(var G=0,E=C.length;G<E;G++){if(C[G].nocheck!==true&&C[G].chkDisabled!==true&&C[G][B]==I){F.push(C[G]);if(H){break}}z.getTreeCheckedNodes(J,C[G][D],I,F);if(H&&F.length>0){break}}return F},getTreeChangeCheckedNodes:function(G,D,F){if(!D){return[]}var H=G.data.key.children,C=G.data.key.checked;F=!F?[]:F;for(var E=0,B=D.length;E<B;E++){if(D[E].nocheck!==true&&D[E].chkDisabled!==true&&D[E][C]!=D[E].checkedOld){F.push(D[E])}z.getTreeChangeCheckedNodes(G,D[E][H],F)}return F},makeChkFlag:function(I,D){if(!D){return}var C=I.data.key.children,B=I.data.key.checked,F=-1;if(D[C]){for(var H=0,E=D[C].length;H<E;H++){var J=D[C][H];var G=-1;if(I.check.chkStyle==r.radio.STYLE){if(J.nocheck===true||J.chkDisabled===true){G=J.check_Child_State}else{if(J.halfCheck===true){G=2}else{if(J[B]){G=2}else{G=J.check_Child_State>0?2:0}}}if(G==2){F=2;break}else{if(G==0){F=0}}}else{if(I.check.chkStyle==r.checkbox.STYLE){if(J.nocheck===true||J.chkDisabled===true){G=J.check_Child_State}else{if(J.halfCheck===true){G=1}else{if(J[B]){G=(J.check_Child_State===-1||J.check_Child_State===2)?2:1}else{G=(J.check_Child_State>0)?1:0}}}if(G===1){F=1;break}else{if(G===2&&F>-1&&H>0&&G!==F){F=1;break}else{if(F===2&&G>-1&&G<2){F=1;break}else{if(G>-1){F=G}}}}}}}}D.check_Child_State=F}},h={},m={onCheckNode:function(F,E){if(E.chkDisabled===true){return false}var D=z.getSetting(F.data.treeId),B=D.data.key.checked;if(u.apply(D.callback.beforeCheck,[D.treeId,E],true)==false){return true}E[B]=!E[B];k.checkNodeRelation(D,E);var C=j(E,r.id.CHECK,D);k.setChkClass(D,C,E);k.repairParentChkClassWithSelf(D,E);D.treeObj.trigger(r.event.CHECK,[F,D.treeId,E]);return true},onMouseoverCheck:function(E,D){if(D.chkDisabled===true){return false}var C=z.getSetting(E.data.treeId),B=j(D,r.id.CHECK,C);D.check_Focus=true;k.setChkClass(C,B,D);return true},onMouseoutCheck:function(E,D){if(D.chkDisabled===true){return false}var C=z.getSetting(E.data.treeId),B=j(D,r.id.CHECK,C);D.check_Focus=false;k.setChkClass(C,B,D);return true}},i={},e={checkNodeRelation:function(K,E){var I,G,F,D=K.data.key.children,C=K.data.key.checked,B=r.radio;if(K.check.chkStyle==B.STYLE){var J=z.getRadioCheckedList(K);if(E[C]){if(K.check.radioType==B.TYPE_ALL){for(G=J.length-1;G>=0;G--){I=J[G];if(I[C]&&I!=E){I[C]=false;J.splice(G,1);k.setChkClass(K,j(I,r.id.CHECK,K),I);if(I.parentTId!=E.parentTId){k.repairParentChkClassWithSelf(K,I)}}}J.push(E)}else{var H=(E.parentTId)?E.getParentNode():z.getRoot(K);for(G=0,F=H[D].length;G<F;G++){I=H[D][G];if(I[C]&&I!=E){I[C]=false;k.setChkClass(K,j(I,r.id.CHECK,K),I)}}}}else{if(K.check.radioType==B.TYPE_ALL){for(G=0,F=J.length;G<F;G++){if(E==J[G]){J.splice(G,1);break}}}}}else{if(E[C]&&(!E[D]||E[D].length==0||K.check.chkboxType.Y.indexOf("s")>-1)){k.setSonNodeCheckBox(K,E,true)}if(!E[C]&&(!E[D]||E[D].length==0||K.check.chkboxType.N.indexOf("s")>-1)){k.setSonNodeCheckBox(K,E,false)}if(E[C]&&K.check.chkboxType.Y.indexOf("p")>-1){k.setParentNodeCheckBox(K,E,true)}if(!E[C]&&K.check.chkboxType.N.indexOf("p")>-1){k.setParentNodeCheckBox(K,E,false)}}},makeChkClass:function(C,F){var B=C.data.key.checked,H=r.checkbox,E=r.radio,G="";if(F.chkDisabled===true){G=H.DISABLED}else{if(F.halfCheck){G=H.PART}else{if(C.check.chkStyle==E.STYLE){G=(F.check_Child_State<1)?H.FULL:H.PART}else{G=F[B]?((F.check_Child_State===2||F.check_Child_State===-1)?H.FULL:H.PART):((F.check_Child_State<1)?H.FULL:H.PART)}}}var D=C.check.chkStyle+"_"+(F[B]?H.TRUE:H.FALSE)+"_"+G;D=(F.check_Focus&&F.chkDisabled!==true)?D+"_"+H.FOCUS:D;return r.className.BUTTON+" "+H.DEFAULT+" "+D},repairAllChk:function(F,I){if(F.check.enable&&F.check.chkStyle===r.checkbox.STYLE){var D=F.data.key.checked,H=F.data.key.children,C=z.getRoot(F);for(var E=0,B=C[H].length;E<B;E++){var G=C[H][E];if(G.nocheck!==true&&G.chkDisabled!==true){G[D]=I}k.setSonNodeCheckBox(F,G,I)}}},repairChkClass:function(C,D){if(!D){return}z.makeChkFlag(C,D);if(D.nocheck!==true){var B=j(D,r.id.CHECK,C);k.setChkClass(C,B,D)}},repairParentChkClass:function(C,D){if(!D||!D.parentTId){return}var B=D.getParentNode();k.repairChkClass(C,B);k.repairParentChkClass(C,B)},repairParentChkClassWithSelf:function(B,D){if(!D){return}var C=B.data.key.children;if(D[C]&&D[C].length>0){k.repairParentChkClass(B,D[C][0])}else{k.repairParentChkClass(B,D)}},repairSonChkDisabled:function(G,I,F,D){if(!I){return}var H=G.data.key.children;if(I.chkDisabled!=F){I.chkDisabled=F}k.repairChkClass(G,I);if(I[H]&&D){for(var E=0,C=I[H].length;E<C;E++){var B=I[H][E];k.repairSonChkDisabled(G,B,F,D)}}},repairParentChkDisabled:function(D,E,C,B){if(!E){return}if(E.chkDisabled!=C&&B){E.chkDisabled=C}k.repairChkClass(D,E);k.repairParentChkDisabled(D,E.getParentNode(),C,B)},setChkClass:function(B,D,C){if(!D){return}if(C.nocheck===true){D.hide()}else{D.show()}D.attr("class",k.makeChkClass(B,C))},setParentNodeCheckBox:function(L,E,K,H){var D=L.data.key.children,B=L.data.key.checked,I=j(E,r.id.CHECK,L);if(!H){H=E}z.makeChkFlag(L,E);if(E.nocheck!==true&&E.chkDisabled!==true){E[B]=K;k.setChkClass(L,I,E);if(L.check.autoCheckTrigger&&E!=H){L.treeObj.trigger(r.event.CHECK,[null,L.treeId,E])}}if(E.parentTId){var J=true;if(!K){var C=E.getParentNode()[D];for(var G=0,F=C.length;G<F;G++){if((C[G].nocheck!==true&&C[G].chkDisabled!==true&&C[G][B])||((C[G].nocheck===true||C[G].chkDisabled===true)&&C[G].check_Child_State>0)){J=false;break}}}if(J){k.setParentNodeCheckBox(L,E.getParentNode(),K,H)}}},setSonNodeCheckBox:function(L,E,K,H){if(!E){return}var D=L.data.key.children,B=L.data.key.checked,I=j(E,r.id.CHECK,L);if(!H){H=E}var C=false;if(E[D]){for(var G=0,F=E[D].length;G<F;G++){var J=E[D][G];k.setSonNodeCheckBox(L,J,K,H);if(J.chkDisabled===true){C=true}}}if(E!=z.getRoot(L)&&E.chkDisabled!==true){if(C&&E.nocheck!==true){z.makeChkFlag(L,E)}if(E.nocheck!==true&&E.chkDisabled!==true){E[B]=K;if(!C){E.check_Child_State=(E[D]&&E[D].length>0)?(K?2:0):-1}}else{E.check_Child_State=-1}k.setChkClass(L,I,E);if(L.check.autoCheckTrigger&&E!=H&&E.nocheck!==true&&E.chkDisabled!==true){L.treeObj.trigger(r.event.CHECK,[null,L.treeId,E])}}}},t={tools:i,view:e,event:h,data:q};f.extend(true,f.fn.zTree.consts,A);f.extend(true,f.fn.zTree._z,t);var c=f.fn.zTree,u=c._z.tools,r=c.consts,k=c._z.view,z=c._z.data,s=c._z.event,j=u.$;z.exSetting(n);z.addInitBind(o);z.addInitUnBind(y);z.addInitCache(d);z.addInitNode(v);z.addInitProxy(p,true);z.addInitRoot(w);z.addBeforeA(a);z.addZTreeTools(l);var x=k.createNodes;k.createNodes=function(E,F,C,B,D){if(x){x.apply(k,arguments)}if(!C){return}k.repairParentChkClassWithSelf(E,B)};var b=k.removeNode;k.removeNode=function(C,D){var B=D.getParentNode();if(b){b.apply(k,arguments)}if(!D||!B){return}k.repairChkClass(C,B);k.repairParentChkClass(C,B)};var g=k.appendNodes;k.appendNodes=function(G,I,C,B,D,F,H){var E="";if(g){E=g.apply(k,arguments)}if(B){z.makeChkFlag(G,B)}return E}})(jQuery);